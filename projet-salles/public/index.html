<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Eben-Hézer - Occupation des salles</title>
    <link rel="stylesheet" href="/resources/styles/style.css" />
    <link rel="icon" type="image/png" href="/resources/images/favicon.png" />
    <script type="module" src="/resources/scripts/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  </head>
  <body>
    <!-- Header -->
    <div class="header">
      <div class="header-info">
        <div class="selector-info">
          <!-- Logo et nom de la salle sélectionée -->
          <img
            id="site-logo"
            src="/resources/images/pga.png"
            alt="Logo PGA avec fond transparent"
            draggable="false"
            style="margin: 0px 15px 0px 15px"
          />
          <!-- Liste déroulante pour le choix de salle -->
          <div class="selector">
            <select id="calendar-select">
              <option disabled><--- LAUSANNE EAU ---></option>
              <option value="Salle_Victoria">Salle Victoria</option>

              <option disabled><--- LAUSANNE MDC ---></option>
              <option value="Salle_des_Pas_Perdus">Salle des Pas Perdus</option>
              <option value="Salle_Julie_Hofmann">Salle Julie Hofmann</option>
              <option value="Salle_Marcel_Jordan">Salle Marcel Jordan</option>
              <option value="Salle_New-York">Salle New-York</option>

              <option disabled><--- LAUSANNE MJH ---></option>
              <option value="Salle_de_culte_MJH">Salle de culte MJH</option>
              <option value="Salle_Oceane">Salle Océane</option>
              <option value="Tente_exterieure_Musardiere">
                Tente extérieure Musardière
              </option>
              <option value="Bureau_Aumoniers-MJH">Bureau Aumôniers-MJH</option>
              <option value="Bureau_CDL-MJH">Bureau CDL-MJH</option>

              <option disabled><--- LAUSANNE PRA ---></option>
              <option value="Chambre_collaborateur">
                Chambre collaborateur
              </option>
              <option value="La_Majeure">La Majeure</option>
              <option value="La_Mineure">La Mineure</option>
              <option value="La_Ronde">La Ronde</option>
              <option value="Salle_Multimedia_CDL">Salle Multimédia CDL</option>
              <option value="Salon">Salon</option>

              <option disabled><--- CITE DU GENEVRIER ---></option>
              <option value="Exploration_sensorielle_grande">
                Exploration sensorielle - grande salle
              </option>
              <option value="Exploration_sensorielle_petite">
                Exploration sensorielle - petite salle
              </option>
              <option value="Piscine">Piscine</option>
              <option value="Rural_de_pra">Rural de pra</option>
              <option value="Salle_administrative">
                Salle admininstrative
              </option>
              <option value="Salle_colloque_pra42">
                Salle colloque Pra 42
              </option>
              <option value="Salle_colloque_pra44">
                Salle colloque Pra 44
              </option>
              <option value="Salle_jaman">Salle Jaman 10-15 personnes</option>
              <option value="Salle_pleiades">
                Salle Pléiades 15 personnes
              </option>
              <option value="Salle_polyvalente">Salle polyvalente</option>
              <option value="Salle_Rochers-de-Naye">
                Salle Rochers-de-Naye
              </option>
              <option value="Salle_sur_eau">Salle Sur eau</option>
              <option value="Salle_willy_fruttiger">
                Salle Willy Fruttiger 20-30 personnes
              </option>

              <option disabled><--- PGA BEAU-SITE ---></option>
              <option value="Salle_PGA_Beau-Site_Vignerons">
                Beau-Site - Salle des Vignerons
              </option>
              <option value="Salle_PGA_Beau-Site_Colloque">
                Beau-Site - Salle Colloque
              </option>
              <option value="Salle_PGA_Beau-Site_Espace-Felix">
                Beau-Site - Salle Espace Felix
              </option>
              <option value="Salle_PGA_Beau-Site_Quart-DHeure-Vaudois">
                Beau-Site - Salle Quart d'heure Vaudois
              </option>
              <option value="Salle_PGA_Beau-Site_Veranda">
                Beau-Site - Salle Véranda
              </option>

              <option disabled><--- PGA BONNETTES ---></option>
              <option value="Salle_PGA_Bonnettes_Colloque">
                Bonnettes - Salle Colloque
              </option>

              <option disabled><--- PGA COTEAU-MURAZ ---></option>
              <option value="Salle_PGA_Coteau-Muraz_Colloque">
                Coteau-Muraz - Salle Colloque
              </option>
            </select>
          </div>
        </div>

        <!-- Heure mise à jour par le script -->
        <div class="time">
          <div id="clock">
            <iframe
              src="https://www.zeitverschiebung.net/clock-widget-iframe-v2?language=fr&size=large&timezone=Europe%2FZurich&show=hour_minute"
              width="100%"
              height="140"
              frameborder="0"
              seamless
              style="pointer-events: none"
            ></iframe>
          </div>
        </div>
      </div>

      <!-- Séparation horizontale -->
      <div class="line"></div>
    </div>

    <!-- Main -->
    <div class="bottom">
      <!-- Partie de gauche -->
      <div class="main">
        <h1 id="status" class="libre"></h1>
        <div class="info-main"></div>
      </div>

      <!-- Séparation -->
      <div class="middle">
        <div class="line"></div>
      </div>

      <!-- Partie de droite -->
      <div class="events"></div>
    </div>

    <!-- Mise à jour de l'URL et des données lors du changement de salle/URL -->
    <script type="module">
      import { ROOMS_DATA } from "/controllers/roomsData.js";

      // Récupération des informations sur le site et le nom de la salle depuis l'URL
      const pathParts = window.location.pathname.split("/");
      const site = pathParts[1] || "pga";
      const salleId = pathParts[2] || "Salle_PGA_Beau-Site_Vignerons";

      // Mise à jour du titre de la salle
      document.getElementById("calendar-select").value = salleId;
      fetchData(site, salleId);

      // Mise à jour de l'URL lors du changement de salle depuis la liste déroulante
      document
        .getElementById("calendar-select")
        .addEventListener("change", (e) => {
          const newSalle = e.target.value;
          const newSite = ROOMS_DATA[newSalle]?.site || "pga";
          window.location.href = `/${newSite}/${newSalle}`;
        });

      async function fetchData(site, id) {
        const res = await fetch(`/api/calendar/${site}/${id}`);
        const events = await res.json();
      }

      const root = document.documentElement;
      const logo = document.getElementById("site-logo");

      // Mise à jour du style et du logo en fonction du site
      switch (site) {
        case "ebhl":
          root.style.setProperty("--main-color", "#f59e00");
          logo.src = "/resources/images/ebhl.png";
          break;
        case "cdg":
          root.style.setProperty("--main-color", "#cb0447");
          logo.src = "/resources/images/cdg.png";
          break;
        default:
          root.style.setProperty("--main-color", "#003595");
          logo.src = "/resources/images/pga.png";
      }
    </script>
  </body>
</html>
