<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Horaires du jour</title>
    <link rel="stylesheet" href="resources/styles/style.css" />
    <script type="module" src="resources/scripts/updateRoom.js"></script>
    <script type="module" src="resources/scripts/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  </head>
  <body>
    <!-- Header -->
    <div class="header">
      <div class="header-info">
        <div class="selector-info">
          <!-- Logo et nom de la salle sélectionée -->
          <img
            src="resources/images/pga.png"
            alt="Logo PGA avec fond transparent"
            draggable="false"
          />
          <!-- Liste déroulante pour le choix de salle -->
          <div class="selector">
            <select id="calendar-select">
              <option value="Salle_PGA_Beau-Site_Vignerons">
                Beau-Site - Salle des Vignerons
              </option>
              <option value="Salle_PGA_Beau-Site_Colloque">
                Beau-Site - Salle Colloque
              </option>
              <option value="Salle_PGA_Beau-Site_Espace-Felix">
                Beau-Site - Salle Espace Felix
              </option>
              <option value="Salle_PGA_Beau-Site_Quart-DHeure-Vaudois">
                Beau-Site - Salle Quart d'heure Vaudois
              </option>
              <option value="Salle_PGA_Beau-Site_Veranda">
                Beau-Site - Salle Véranda
              </option>
              <option value="Salle_PGA_Bonnettes_Colloque">
                Bonnettes - Salle Colloque
              </option>
              <option value="Salle_PGA_Coteau-Muraz_Colloque">
                Coteau-Muraz - Salle Colloque
              </option>
            </select>
          </div>
        </div>

        <!-- Heure mise à jour par le script -->
        <div class="time">
          <div id="clock"></div>
        </div>
      </div>

      <!-- Séparation horizontale -->
      <div class="line"></div>
    </div>

    <!-- Main -->
    <div class="bottom">
      <!-- Partie de gauche -->
      <div class="main">
        <h1 id="status" class="libre"></h1>
        <div class="info-main"></div>
      </div>

      <!-- Séparation -->
      <div class="middle">
        <div class="line"></div>
      </div>

      <!-- Partie de droite -->
      <div class="events"></div>
    </div>

    <!-- Mise à jour de l'URL et des données lors du changement de salle/URL -->
    <script>
      const salleId =
        window.location.pathname.split("/")[1] ||
        "Salle_PGA_Beau-Site_Vignerons";

      document.getElementById("calendar-select").value = salleId;
      fetchData(salleId);

      document
        .getElementById("calendar-select")
        .addEventListener("change", (e) => {
          const newSalle = e.target.value;
          window.location.href = `/${newSalle}`;
        });

      async function fetchData(id) {
        const res = await fetch(`/api/calendar/${id}`);
        const events = await res.json();
      }
    </script>
  </body>
</html>
